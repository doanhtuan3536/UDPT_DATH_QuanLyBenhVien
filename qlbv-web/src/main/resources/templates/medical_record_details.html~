<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org" xmlns:sec="https://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chi Tiết Hồ Sơ Bệnh Án</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        .timeline {
            border-left: 3px solid #0d6efd;
            border-bottom-right-radius: 4px;
            border-top-right-radius: 4px;
            position: relative;
            margin: 20px 0;
        }
        .timeline-item {
            position: relative;
            margin-bottom: 20px;
            padding-left: 25px;
        }
        .timeline-item:last-child {
            margin-bottom: 0;
        }
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -8px;
            top: 0;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #0d6efd;
            border: 3px solid white;
        }
        .exam-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .exam-card:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .wrapper {
            flex-grow: 1;
        }

        .header {
            background-color: #2c3e50;
            color: white;
            padding: 1rem 5%; /* Sử dụng phần trăm để responsive tốt hơn */
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .user-info a {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
            text-decoration: none;
        }

        .user-info a:hover {
            background-color: #c0392b;
        }
        .footer {
            background-color: #2c3e50;
            color: white;
            text-align: center;
            padding: 1.5rem;
        }

        @media (max-width: 768px) {

            .header {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
                padding: 1rem;
            }
        }
    </style>
</head>
<body class="bg-light">
<div class="wrapper">
    <!--    <header class="header">-->
    <!--        <div class="logo">Hệ thống Quản lý Bệnh viện</div>-->
    <!--        <div class="user-info" sec:authorize="isAuthenticated()">-->
    <!--            <span th:text="'Xin chào, ' + (${#authentication.principal.hoten} ?: ${#authentication.principal.userName})"></span>-->
    <!--            <a href="/logout">Đăng xuất</a>-->
    <!--        </div>-->
    <!--    </header>-->
    <div th:replace="header :: header">...</div>
    <div class="container mt-4">
        <!-- Breadcrumb -->
        <nav aria-label="breadcrumb" class="mb-4">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/home">Trang Chủ</a></li>
                <li class="breadcrumb-item"><a href="/medical-records">Hồ Sơ Bệnh Án</a></li>
                <li class="breadcrumb-item active">HSBA-2023-0015</li>
            </ol>
        </nav>

        <!-- Medical Record Header -->
        <div class="card shadow-sm mb-4">
            <div class="card-header bg-primary text-white">
                <h5 class="card-title mb-0">
                    <i class="fas fa-file-medical me-2"></i>HỒ SƠ BỆNH ÁN #HSBA-2023-0015
                </h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="fw-bold text-muted">Ngày tạo hồ sơ:</label>
                            <p class="mb-0">25/10/2023</p>
                        </div>
                        <div class="mb-3">
                            <label class="fw-bold text-muted">Bác sĩ điều trị chính:</label>
                            <div class="d-flex align-items-center">
<!--                                <img src="/api/placeholder/50/50" alt="Bác sĩ" class="rounded-circle me-2">-->
                                <span>BS. Nguyễn Văn A</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="mb-3">
                            <label class="fw-bold text-muted">Tình trạng hiện tại:</label>
                            <span class="badge bg-success">Đã kết thúc điều trị</span>
                        </div>
                        <div class="mb-3">
                            <label class="fw-bold text-muted">Tóm tắt điều trị:</label>
                            <p class="mb-0">Nhập viện vì đau bụng dữ dội. Đã nội soi và điều trị nội khoa. Sức khỏe ổn định và xuất viện sau 3 ngày.</p>
                        </div>
                    </div>
                </div>
                <div class="mt-3">
                    <label class="fw-bold text-muted">Tình trạng sức khỏe chi tiết:</label>
                    <div class="border rounded p-3 bg-light">
                        <p class="mb-0">Bệnh nhân nhập viện với triệu chứng đau bụng vùng thượng vị. Kết quả nội soi chẩn đoán viêm dạ dày cấp. Đã điều trị bằng thuốc kháng acid và thay đổi chế độ ăn uống. Tình trạng ổn định, cần tái khám sau 1 tuần.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Examination History -->
        <div class="card shadow-sm">
            <div class="card-header bg-info text-white">
                <h5 class="card-title mb-0">
                    <i class="fas fa-history me-2"></i>LỊCH SỬ THĂM KHÁM
                </h5>
            </div>
            <div class="card-body">
                <!-- Timeline View for Examinations -->
                <div class="timeline">
                    <!-- Examination Item 1 -->
                    <div class="timeline-item">
                        <div class="card exam-card mb-3">
                            <div class="card-header bg-white d-flex justify-content-between align-items-center">
                                <div>
                                    <h6 class="mb-0">27/10/2023 - 08:30</h6>
                                    <small class="text-muted">BS. Trần Thị C</small>
                                </div>
                                <button class="btn btn-sm btn-outline-primary" data-bs-toggle="collapse" data-bs-target="#examDetail1">
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                            </div>
                            <div class="card-body">
                                <p class="card-text"><strong>Chẩn đoán:</strong> Kiểm tra cuối đợt điều trị, tình trạng ổn định</p>
                                <div class="collapse" id="examDetail1">
                                    <div class="mt-3">
                                        <h6>Triệu chứng chủ quan:</h6>
                                        <p class="text-muted">Bệnh nhân cho biết không còn đau bụng, ăn uống ngon miệng.</p>

                                        <h6>Triệu chứng khách quan:</h6>
                                        <p class="text-muted">Da dẻ hồng hào, bụng mềm, không đau khi ấn.</p>

                                        <h6>Kế hoạch điều trị:</h6>
                                        <p class="text-muted">Cho xuất viện, hẹn tái khám sau 1 tuần.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Examination Item 2 -->
                    <div class="timeline-item">
                        <div class="card exam-card mb-3">
                            <div class="card-header bg-white d-flex justify-content-between align-items-center">
                                <div>
                                    <h6 class="mb-0">26/10/2023 - 09:15</h6>
                                    <small class="text-muted">BS. Nguyễn Văn A</small>
                                </div>
                                <button class="btn btn-sm btn-outline-primary" data-bs-toggle="collapse" data-bs-target="#examDetail2">
                                    <i class="fas fa-chevron-down"></i>
                                </button>
                            </div>
                            <div class="card-body">
                                <p class="card-text"><strong>Chẩn đoán:</strong> Theo dõi điều trị, tình trạng cải thiện tốt</p>
                                <div class="collapse" id="examDetail2">
                                    <div class="mt-3">
                                        <h6>Triệu chứng chủ quan:</h6>
                                        <p class="text-muted">Bệnh nhân báo cáo giảm đau đáng kể, có thể ăn cháo.</p>

                                        <h6>Triệu chứng khách quan:</h6>
                                        <p class="text-muted">Mạch, huyết áp ổn định. Bụng ấn đỡ đau hơn.</p>

                                        <h6>Kế hoạch điều trị:</h6>
                                        <p class="text-muted">Tiếp tục phác đồ điều trị hiện tại.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Thêm các lần khám khác ở đây -->
                </div>

                <!-- Empty State for Examinations -->
                <div class="text-center py-4 d-none" id="emptyExams">
                    <i class="fas fa-stethoscope fa-2x text-muted mb-2"></i>
                    <p class="text-muted mb-0">Chưa có lịch sử thăm khám nào cho hồ sơ này</p>
                </div>
            </div>
        </div>

</div>

<div th:replace="footer :: footer">...</div>

<!-- Main Content -->


</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // JavaScript để xử lý collapse và các tương tác khác
    document.addEventListener('DOMContentLoaded', function() {
        // Kiểm tra nếu không có lần khám nào
        const timeline = document.querySelector('.timeline');
        const emptyExams = document.getElementById('emptyExams');

        if (timeline.children.length === 0) {
            emptyExams.classList.remove('d-none');
        }

        // Xử lý sự kiện click cho các card
        const examCards = document.querySelectorAll('.exam-card');
        examCards.forEach(card => {
            card.addEventListener('click', function(e) {
                if (!e.target.closest('.btn')) {
                    const collapseId = this.querySelector('[data-bs-toggle="collapse"]').dataset.bsTarget;
                    const collapseElement = document.querySelector(collapseId);
                    new bootstrap.Collapse(collapseElement).toggle();
                }
            });
        });
    });
</script>
</body>
</html>